function ulsChatJSON(){var e=decodeURIComponent(jQuery("#uls-chat-data").data("feed")),a=jQuery("#uls-chat-contents");jQuery.ajax({url:e,dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",success:function(e){e&&jQuery("#q555490_q1").val(JSON.stringify(e));var t="";jQuery.each(e,function(e,a){0==a.admin&&(t+='<div class="cell large-8"><span class="fas fa-user" aria-hidden="true"></span>&nbsp;&nbsp;'+a.message+"</div>"),1==a.admin&&(t+='<div class="cell large-8 large-offset-4 text-right">'+a.message+'&nbsp;&nbsp;<img src="https://cdn.ulster.ac.uk/home/ulster-frontend/favicons/apple-touch-icon-57x57.png" width="30" /></div>')}),a.html(t)},error:function(e,a,t){console.log(t)}})}function ulsDoPoll(){"2"==jQuery("#SQ_FORM_555463_PAGE").val()&&(jQuery("#form_email_555463").on("submit",function(e){e.preventDefault()}),ulsChatJSON(),console.log("Poll")),setTimeout(ulsDoPoll,800)}jQuery(document).ready(function(){if(jQuery(".uls-page-2-init").length>0&&jQuery(".uls-page-2-init").click(),"2"==jQuery("#SQ_FORM_555463_PAGE").val()&&jQuery("#q555490_q1").val()){var e=decodeURIComponent(jQuery("#uls-chat-data").data("feed")),a=[];jQuery.ajax({url:e,dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",success:function(e){a=jQuery("#q555490_q1").val()?JSON.parse(e):[]},error:function(e,t,u){a=[],console.log("error with load ajax!"),console.log(e.status),console.log(u)}})}ulsDoPoll(),jQuery("#uls-live-chat-input").bind("enterKey",function(e){jQuery("#uls-live-chat-input").val()&&jQuery("#uls-send-chat-msg").click()}),jQuery("#uls-live-chat-input").keyup(function(e){13==e.keyCode&&jQuery(this).trigger("enterKey")}),jQuery("#uls-send-chat-msg").on("click",function(e){e.preventDefault();var a=jQuery("input[name=uls-chat-text]").val(),t=jQuery("#uls-live-chat").data("userid"),u=jQuery("#uls-live-chat").data("check"),n={};if(n.userid=t,n.message=a,n.admin=u,jQuery("#q555490_q1").val()){var l=jQuery("#q555490_q1").val();l=JSON.parse(l)}else var l=[];l.push(n),jQuery("#q555490_q1").val(JSON.stringify(l)),jQuery("#form_email_555463").ajaxForm(),jQuery("#form_email_555463").ajaxSubmit({success:function(){ulsChatJSON(),jQuery("input[name=uls-chat-text]").val("")},error:function(){console.log("error with ajaxSubmit.")}})})});